/**
 * Created by MrLutin on 2017-12-22.
 */

function getPlayersOnline(){
    $.get('api/getOnlinePlayers').done(function( data ){
        $('#onlinePlayers').html(data + "/32");
        console.log('utilisateur en ligne = ' + data)
    })
}


function postAlertModal(title, text, type, url, data){

    swal({
        title: title,
        text: text,
        type: type,
        confirmButtonClass: 'btn btn-success',
        confirmButtonText: 'Valider',
        cancelButtonClass: 'btn btn-light',
        cancelButtonText: 'Annuler',
        background: 'rgba(0, 0, 0, 0.96)',
        showCancelButton: true,
        showLoaderOnConfirm: true,
        allowOutsideClick: false,
        preConfirm:
            setTimeout(function () {

                $.ajax({
                    type: "POST",
                    url: url,
                    data: data,
                    success: function(request){
                        var req = $.parseJSON(request);
                        swal({
                            title: req.title,
                            text: req.text,
                            type: 'success',
                            confirmButtonText: 'Terminer',
                            confirmButtonClass: 'btn btn-light',
                            background: 'rgba(0, 0, 0, 0.96)',
                            showLoaderOnConfirm: true,
                            allowOutsideClick: false,
                            preConfirm: function(){ setTimeout(document.location.reload(true),5000) }

                        });
                    },
                    error: function(XMLHttpRequest, textStatus, errorThrown) {
                        apiError(XMLHttpRequest, textStatus, errorThrown);
                    }
                });

            }, 3000)
    })
}

function apiError(xhr, status, error){
    swal({
        title: 'Oupss, ['+ error +']',
        text: "L'api n'as pas répondu a la requête",
        type: 'warning',
        buttonsStyling: false,
        confirmButtonText: 'Terminer',
        confirmButtonClass: 'btn btn-light',
        background: 'rgba(0, 0, 0, 0.96)'
    });
}